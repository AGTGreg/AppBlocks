var AppBlock=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t=function(e,t,n){var i,o=t[0],s=e;if(n&&o in n){if(!(t.length>1))return n[o];t.shift(),s=n[o]}else o in e.methods&&(t.shift(),i=e.methods[o](e));if(t.length>0)for(var a=0;a<t.length&&void 0!==(i=r(s,t[a]));a++)s=i;return e.debug&&console.info("Result for",t,":",i),i},n={getNode:function(e){return this.comp.el.querySelector(e)},getNodes:function(e){return this.comp.el.querySelectorAll(e)},appendIn:function(e,t){return t.innerHTML+=e},prependIn:function(e,t){return t.innerHTML=e+t.innerHTML}},r=function(e,t){var n=e[t];if(void 0===n){var r=t.match(/\[(.*?)\]/g);if(r)for(var i=e[t.split("[")[0]],o=0;o<r.length;o++){if(o>0&&(i=n),void 0===(n=i[r[o].split("[")[1].split("]")[0]]))break}}return n},i=function(n,r,i){if(!1!==/{([^}]+)}/.test(r)){e(i);var o=r.replace(/{|}/g,"").split("."),s=t(n,o,i);return void 0===s?"":s}},o=function(e,t,n){for(var r=t.attributes,o=0;o<r.length;o++)if(/{([^}]+)}/.test(r[o].value))for(var s=r[o].value.match(/{([^}]+)}/g),a=0;a<s.length;a++){var c=new RegExp(s[a],"g");r[o].value=r[o].value.replace(c,i(e,s[a],n))}},s=function(e,t,n){for(var r=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,{acceptNode:function(e){if(/{([^}]+)}/.test(e.data))return NodeFilter.FILTER_ACCEPT}});r.nextNode();){for(var o=r.currentNode.nodeValue,s=o.match(/{([^}]+)}/g),a=0;a<s.length;a++)o=o.replace(s[a],i(e,s[a],n));r.currentNode.nodeValue=o}},a=function e(t,n,r){var i=n.attributes;if(i){for(var s=0;s<i.length;s++)if(i[s].name in t.directives){var a=i[s].name;if(!1===t.directives[a](t,n,r))return void n.remove()}o(t,n,r)}if(n.hasChildNodes())for(var c=n.childElementCount-1;c>=0&&n.children[c];c--)e(t,n.children[c],r)},c={"c-if":function(n,r,i){var o=r.getAttribute("c-if");null===o&&(o=r.getAttribute("c-ifnot"));var s=t(n,o.split("."),i);if(void 0===s)for(var a=[" == "," === "," !== "," != "," > "," < "," >= "," <= "],c=["boolean","number","undefined"],u=0;u<a.length;u++)if(o.includes(a[u])){var f=o,l=f.split(a[u]),d=t(n,l[0].split("."),i);if(!1===c.includes(String(e(d))))return n.debug&&console.warn(l[0]+" cannot be evaluated because it is not a boolean nor a number."),!1;f=f.replace(l[0],d),s=(0,eval)(f)}return!([void 0,null,!1,0,""].indexOf(s)>-1)&&(r.removeAttribute("c-if"),!0)},"c-ifnot":function(e,t,n){var r=!c["c-if"](e,t,n);return!0===r&&t.removeAttribute("c-ifnot"),r},"c-for":function(e,n,r){var i=n.getAttribute("c-for"),c=i.split(" in "),u=c[0],f=c[1].split(".");void 0===r&&(r={});var l=t(e,f,r);if(l){n.removeAttribute("c-for");for(var d=n.parentNode,h=0;h<l.length;h++){var p=l[h];r[u]=p;var v=n.cloneNode(!0);a(e,v,r),o(e,v,r),s(e,v,r),u=(c=i.split(" in "))[0],d.appendChild(v)}return n.remove(),!0}return!1}},u=require("idiomorph/dist/idiomorph.cjs");return function(e){var t=this;return this.debug=!1,this.setData=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.data=e:Object.assign(this.data,e),this.render()},this.resetState=function(){this.state.loading=!1,this.state.error=!1,this.state.success=!1},this.axiosRequest=function(e,n,r){return function(e,t,n,r){if(!e.state.loading){e.resetState(),e.state.loading=!0;var i=r||0;e.render((function(){setTimeout((function(){axios.request(t).then((function(t){if(e.state.success=!0,n&&n.success instanceof Function){var r=n.success(t);r instanceof Object&&(t=r)}})).catch((function(t){e.state.error=!0,n&&n.error instanceof Function&&n.error(t)})).then((function(){e.state.loading=!1,n&&n.finally instanceof Function&&n.finally(),e.render()}))}),i)}))}}(t,e,n,r)},this.fetchRequest=function(e,n,r,i){return function(e,t,n,r,i){if(!e.state.loading){e.resetState(),e.state.loading=!0;var o=i||0;e.render((function(){setTimeout((function(){fetch(t,n).then((function(e){return e.json()})).then((function(e){e.error?(app.state.error=!0,r&&r.error instanceof Function&&r.error(e)):(app.state.success=!0,r&&r.success instanceof Function&&r.success(e))})).catch((function(e){app.state.error=!0,r&&r.error instanceof Function&&r.error(e)})).finally((function(){app.state.loading=!1,r&&r.finally instanceof Function&&r.finally(),app.render()}))}),o)}))}}(t,e,n,r,i)},this.prepareTmpDom=function(){var e=this,t=e.template.cloneNode(!0);return a(e,t),s(e,t),t},this.render=function(e){var t=this;t.methods.beforeRender instanceof Function&&t.methods.beforeRender(t);var n=this.prepareTmpDom();console.time(t.renderEngine+" render time"),"Idiomorph"===t.renderEngine?t.idiomorphRender(n):"plain"===t.renderEngine?t.plainRender(n):console.error("".concat(t.renderEngine," renderEngine does not exist.")),console.timeEnd(t.renderEngine+" render time"),t.methods.afterRender instanceof Function&&t.methods.afterRender(t),e instanceof Function&&e()},this.plainRender=function(e){this.el.innerHTML="",this.el.appendChild(e)},this.idiomorphRender=function(e){u.morph(this.el,e,{morphStyle:"innerHTML"})},this.Init=function(){var t=this;if(e.debug&&(t.debug=!0),void 0===e)return!1;if(void 0!==e.el){if(null!==e.el){if(t.el=e.el,t.renderEngine=e.renderEngine?e.renderEngine:"plain",e.template)t.template=e.template.content;else for(t.template=document.createDocumentFragment();t.el.firstChild;)t.template.appendChild(t.el.firstChild);if(t.state={loading:!1,error:!1,success:!1},t.data={},e.data instanceof Object&&(t.data=e.data),t.utils=n,t.utils.comp=t,t.methods={Parent:t,isLoading:function(e){return e.state.loading},isSuccessful:function(e){return e.state.success},hasError:function(e){return e.state.error},beforeRender:function(e){},afterRender:function(e){}},e.methods instanceof Object&&Object.assign(t.methods,e.methods),t.directives=c,e.directives instanceof Object&&Object.assign(t.directives,e.directives),t.events={},e.events instanceof Object){Object.assign(t.events,e.events);var r=function(e){var n=e.split(" "),r=n[0],i=n[1];t.el.addEventListener(r,(function(n){t.el.querySelectorAll(i).forEach((function(r){n.srcElement===r&&t.events[e](n)}))}))};for(var i in t.events)r(i)}return t.events.Parent=t,t.render(),t}t.debug&&console.warn("The element you assigned to el is not present. Current AppBlock is exiting.")}else t.debug&&console.warn("el is empty. Please assign a DOM element to el. Current AppBlock is exiting.")},this.Init()}}();
